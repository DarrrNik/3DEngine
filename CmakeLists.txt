cmake_minimum_required(VERSION 3.31)
project(3DEngine VERSION 0.0.1 LANGUAGES CXX)

set(CMAKE_CXX_STANDARD 20)

set(WORKING_DIRECTORY ${CMAKE_SOURCE_DIR}/Workdir)
set(MINGW_BIN C:/msys64/mingw64/bin)

add_subdirectory("${CMAKE_SOURCE_DIR}/Scene")

set(CMAKE_AUTOUIC ON)
set(CMAKE_AUTOMOC ON)
set(CMAKE_AUTORCC ON)

set(CMAKE_AUTOUIC_SEARCH_PATHS ${CMAKE_SOURCE_DIR}/form)

set(CMAKE_PREFIX_PATH "C:/msys64/")

find_package(Qt6 REQUIRED COMPONENTS 
    Core 
    Widgets 
    OpenGLWidgets
)

include_directories(
    ${CMAKE_SOURCE_DIR}/include/
)

qt_standard_project_setup()

file(GLOB_RECURSE PROJECT_SOURCES
    ${CMAKE_SOURCE_DIR}/src/*.cpp
    ${CMAKE_SOURCE_DIR}/include/*.hpp
    ${CMAKE_SOURCE_DIR}/form/*.ui
)

add_executable(${PROJECT_NAME}
    ${PROJECT_SOURCES}
)

set_target_properties(${PROJECT_NAME} PROPERTIES
    WIN32_EXECUTABLE TRUE
    VS_DEBUGGER_WORKING_DIRECTORY "${WORKING_DIRECTORY}"
)

target_link_libraries(${PROJECT_NAME} PRIVATE Qt6::Core Qt6::Widgets Qt6::OpenGLWidgets)

add_custom_command(TARGET ${PROJECT_NAME} POST_BUILD
    COMMAND ${CMAKE_COMMAND} -E copy
        $<TARGET_FILE:${PROJECT_NAME}>
        ${WORKING_DIRECTORY}
)
